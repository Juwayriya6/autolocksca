<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contact | Autolocks</title>
  <meta name="description" content="Contact Autolocks — 24/7 locksmiths serving Edmonton, St. Albert, Leduc, Spruce Grove, Fort Saskatchewan, Sherwood Park & Stony Plain. Call 587-926-3231 or send a message." />
  <link rel="stylesheet" href="assets/css/main.css" />
</head>

<body>
  <nav class="nav">
    <a class="logo" href="index.html">Autolocks</a>
    <div class="nav-right">
      <a class="nav-link" href="index.html">Home</a>
      <a class="nav-link" href="services.html">Services</a>
      <a class="nav-link active" href="contact.html">Contact</a>
      <a class="btn call" href="tel:5879263231">Call Us</a>
    </div>
  </nav>

  <header class="hero hero-short">
    <img src="assets/images/contact-header.png" alt="Contact Autolocks" />
    <div class="hero-card">
      <h1>Contact Us</h1>
      <p>We’re here 24/7 • <a href="tel:5879263231">587-926-3231</a></p>
      <p class="regions">Edmonton • St. Albert • Leduc • Spruce Grove • Fort Saskatchewan • Sherwood Park • Stony Plain</p>
    </div>
  </header>

  <main class="container">
    <section class="contact-grid">
      <div>
        <h2>Send a Message</h2>
        <form id="contact-form"
              name="contact-form"
              method="POST"
              action="thank-you.html"
              data-netlify="true"
              data-netlify-recaptcha="true"
              netlify-honeypot="bot-field">
          <input type="hidden" name="form-name" value="contact-form" />
          <p class="hidden"><label>Don’t fill this out: <input name="bot-field" /></label></p>
          <input type="text" name="name" placeholder="Your Name" required />
          <input type="tel" name="phone" placeholder="Phone (recommended)" />
          <input type="email" name="email" placeholder="Email" required />
          <textarea name="message" rows="5" placeholder="How can we help?" required></textarea>

          <!-- Hidden reCAPTCHA v3 token field -->
          <input type="hidden" id="g-recaptcha-token" name="g-recaptcha-token">

          <button type="submit" class="btn">Send Message</button>

          <!-- Inline success and error messages -->
          <p id="success-message" style="display:none; color:green; margin-top:1rem;">
            ✅ Thank you! Your message has been sent successfully.
          </p>
          <p id="error-message" style="display:none; color:red; margin-top:1rem;">
            ⚠️ Oops! Something went wrong. Please try again later.
          </p>
        </form>
      </div>

      <aside class="contact-card">
        <h3>Autolocks</h3>
        <p><strong>Phone:</strong> <a href="tel:5879263231">587-926-3231</a></p>
        <p><strong>Email:</strong> <a href="mailto:autolocksca@gmail.com">autolocksca@gmail.com</a></p>
        <p>Serving Edmonton, St. Albert, Leduc, Spruce Grove, Fort Saskatchewan, Sherwood Park & Stony Plain — 24/7.</p>
        <button class="btn outline" data-open-popup>Request Service</button>
      </aside>
    </section>
  </main>

  <footer class="footer">
    <p>&copy; 2025 Autolocks.ca — All Rights Reserved</p>
  </footer>

  <!-- Shared popup -->
  <div id="service-popup" aria-hidden="true">
    <div class="popup-card" role="dialog" aria-modal="true" aria-label="Request Service Form">
      <button class="close" aria-label="Close popup" data-close-popup>&times;</button>
      <h2>Request Service</h2>
      <form id="service-form"
            name="service-request"
            method="POST"
            action="thank-you.html"
            data-netlify="true"
            data-netlify-recaptcha="true"
            netlify-honeypot="bot-field">
        <input type="hidden" name="form-name" value="service-request" />
        <p class="hidden"><label>Don’t fill this out: <input name="bot-field" /></label></p>
        <input type="text" name="name" placeholder="Your Name" required />
        <input type="tel" name="phone" placeholder="Phone (recommended)" />
        <input type="email" name="email" placeholder="Email" required />
        <textarea name="message" rows="4" placeholder="Describe your issue" required></textarea>

        <!-- Hidden reCAPTCHA v3 token field -->
        <input type="hidden" id="g-recaptcha-token-popup" name="g-recaptcha-token">

        <button type="submit" class="btn full">Send Request</button>

        <!-- Inline popup success/error messages -->
        <p id="popup-success" style="display:none; color:green; margin-top:1rem;">✅ Request sent successfully!</p>
        <p id="popup-error" style="display:none; color:red; margin-top:1rem;">⚠️ Could not send request. Try again.</p>
      </form>
    </div>
  </div>

  <!-- reCAPTCHA v3 Script -->
  <script src="https://www.google.com/recaptcha/api.js?render=6LfOR_crAAAAAHWZqK_7R79iHHfhddBlBUas2y2T"></script>

  <script>
    // Handle both forms (main contact + popup)
    function handleFormSubmit(formId, tokenFieldId, successId, errorId) {
      const form = document.getElementById(formId);
      if (!form) return;
      const successMsg = document.getElementById(successId);
      const errorMsg = document.getElementById(errorId);

      form.addEventListener("submit", function (event) {
        event.preventDefault();
        grecaptcha.ready(function () {
          grecaptcha.execute("6LfOR_crAAAAAHWZqK_7R79iHHfhddBlBUas2y2T", { action: "submit" })
            .then(function (token) {
              document.getElementById(tokenFieldId).value = token;

              const formData = new FormData(form);
              fetch("/", { method: "POST", body: formData })
                .then((response) => {
                  if (response.ok) {
                    form.reset();
                    successMsg.style.display = "block";
                    errorMsg.style.display = "none";
                  } else throw new Error("Network response not ok");
                })
                .catch(() => {
                  successMsg.style.display = "none";
                  errorMsg.style.display = "block";
                });
            });
        });
      });
    }

    // Initialize both
    handleFormSubmit("contact-form", "g-recaptcha-token", "success-message", "error-message");
    handleFormSubmit("service-form", "g-recaptcha-token-popup", "popup-success", "popup-error");
  </script>

  <script src="assets/js/main.js"></script>
</body>
</html>